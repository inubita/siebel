javascript:(function(){function e(e,p){if(p=p?p:$("#"+n).val(),p&&p.replace(/\*/gm,"").length<3)return void i("Value should be longer then 3 characters! "+p);e||d.find(o+"List").empty(),p&&(s.indexOf(p)>-1&&s.splice(p,1),s.unshift(p),s.length>5&&s.pop(),window.localStorage[n]=JSON.stringify(s));var c=SiebelApp.S_App.GetService("FWK Runtime"),l=SiebelApp.S_App.NewPropertySet();l.SetProperty("Name",p),l.SetProperty("Inspect",e?"Y":"N"),l.SetProperty("Limit",r);var u={async:!0,scope:this,mask:!0,cb:function(e,n,s){if("Error"==s.GetProperty("Status"))sRes=s.GetChildByType("Errors").GetChild(0).GetProperty("ErrMsg");else{var a=s.GetChildByType("ResultSet");if(a&&(sRes=a.GetProperty("Result"),sWorkspaces=a.GetProperty("Workspaces"),!sRes))if("Y"==n.GetProperty("Inspect"))sRes="Workspace <b><a href='#'>"+(sWorkspaces||"?")+"</a></b> inspected sucessfully!";else if(sWorkspaces){d.find(o+"List").empty();var c=sWorkspaces.split(",");c.forEach(function(e){return d.find(o+"List").append("<li><a href='#'>"+t(p,e)+"</a></li>")}),c.length==r&&d.find(o+"List").append("<p><i>"+r+" most recent workspaces are shown.</i></p>")}}sRes&&i(sRes)}};i((e?"Inspecting":"Searching for")+" workspace: "+(p||a)),c.InvokeMethod("InspectWS",l,u)}function t(e,t){return e&&t&&!e.match(/\[.*\]/gm)&&e.replace(/\*/gm,"").length<t.length&&function(){var i=e.split("*"),n=-1;t=i.reduce(function(e,t){var i=e.indexOf(t,n);return t&&i>-1&&(e=e.substr(0,i)+"<b>"+t+"</b>"+e.substr(i+t.length),n=i),e},t)}(),t}function i(e){e=(new Date).toLocaleTimeString()+" >> "+e,p.push(e),p.length>3&&p.shift(),d.find(o+"Msg").html(p.join("<br>"))}if("undefined"==typeof SiebelApp)return void alert("It works only in Siebel OUI session!");var n="SiebelInspectWS",o="#"+n,r=10,s=JSON.parse(window.localStorage[n]||"[]"),p=[];if($("."+n).length)return void $("."+n).find(o+"IBtn").click();var a=(SiebelApp.S_App.GetUserName()||"my")+" recent undelivered workspace",c='<i><p>Welcome to Inspect Workspace UI</p>Text field accepts several formats:<br><ul><li> - an exact workspace name: vbabkin_20200924_d419_1</li><li> - a search pattern of workspace name: *d419*</li><li> - an exact search spec for Repository Workspace BC: [Parent Name] = "Release 21" AND [Created By] = LoginId()</li><li> - leave it empty to search / inspect most recent undelivered workspaces created by active user</li></ul><p>Hit Enter to search for 10 most recent workspaces matching the provided name/pattern/spec and then click one of the workspaces in the list to inspect it.</p><p>Hit Ctrl+Enter to inspect the most recent workspaces matching the provided name/pattern/spec.</p><p>If you want to inspect/re-inspect your recent undelivered workspace, just hit Ctrl+Enter upon opening a dialog or double click a bookmark link.</p><p>Right click on workspace name to copy it.</p><p>Click anywhere outside of the dialog to close it.</p><p>Check out <a href="http://xapuk.com/index.php?topic=125" target="_blank">http://xapuk.com/</a> for details.</p></i>',l='<div title="Inspect Workspace"><span id = "'+n+'Help" style = "display:none">'+c+'</span><input placeholder = "<'+a+'>" type="text" id = "'+n+'" list="'+n+'History" autocomplete="off"><ul id="'+n+'List"></ul><p id = "'+n+'Msg"></p><datalist id = "'+n+'History"></datalist><style>.'+n+" input {width: 100%!Important;}#"+n+"::placeholder {color: lightslategrey;}#"+n+"List {margin-left: 15px;}#"+n+"Help i {font-size: 0.9rem;}."+n+" li {list-style-type: disc;margin-left: 30px;}#"+n+"Msg {border-top:1px solid;}</style></div>",d=$(l).dialog({modal:!0,width:640,classes:{"ui-dialog":n},buttons:[{text:"Search (Enter)",click:function(){return e(!1)}},{id:n+"IBtn",text:"Inspect (Ctrl+Enter)",click:function(){return e(!0)}},{text:"Help",click:function(){return d.find(o+"Help").toggle()}},{text:"Close (Esc)",click:function(){return d.dialog("close")}}],open:function(){var t=$(this);t.find("#"+n).focus(),t.parent(".ui-dialog").contextmenu(function(e){var t=this,i=e.target;"A"===i.nodeName&&(e.stopPropagation(),e.preventDefault(),$(i).hide().after("<input id='"+n+"Copy'>"),d.find(o+"Copy").val($(i).text()).select(),document.execCommand("copy",!1,null)?(d.find(o+"Copy").attr("disabled","disabled").css("color","red").val("Copied!"),setTimeout(function(){d.find(o+"Copy").remove(),$(i).show()},700)):d.find(o+"Copy").blur(function(){$(t).remove(),d.find("a").show()}))}).click(function(t){var i=$(t.target).closest("a");i.length&&i.closest(o+"List").length&&e(!0,i.text())}).find(o).keydown(function(t){13===t.keyCode&&e(t.ctrlKey)}),$(".ui-widget-overlay").click(function(){return d.dialog("close")}),s.forEach(function(e){return t.find(o+"History").append("<option>"+e+"</option>")})},close:function(){d.dialog("destroy").remove()}})})();