javascript:(function(){function e(e,a){if(a=a?a:$("#"+n).val(),a&&a.replace(/\*/gm,"").length<3)return void l.find(o+"Msg").html("Value can't be shorter then 3 characters!");a&&(s.indexOf(a)>-1&&s.splice(a,1),s.unshift(a),s.length>5&&s.pop(),window.localStorage[n]=JSON.stringify(s));var p=SiebelApp.S_App.GetService("FWK Runtime"),c=SiebelApp.S_App.NewPropertySet();c.SetProperty("Name",a),c.SetProperty("Inspect",e?"Y":"N"),c.SetProperty("Limit",r);var d={async:!0,scope:this,mask:!0,cb:function(e,n,s){if("Error"==s.GetProperty("Status"))sRes=s.GetChildByType("Errors").GetChild(0).GetProperty("ErrMsg");else{var p=s.GetChildByType("ResultSet");if(p&&(sRes=p.GetProperty("Result"),sWorkspaces=p.GetProperty("Workspaces"),!sRes))if("Y"==n.GetProperty("Inspect"))sRes="Workspace <b><a href='#'>"+(sWorkspaces||"?")+"</a></b> inspected sucessfuly!";else if(sWorkspaces){l.find(o+"List").empty();var c=sWorkspaces.split(",");c.forEach(function(e){return l.find(o+"List").append("<li><a href='#'>"+t(a,e)+"</a></li>")}),c.length==r&&l.find(o+"List").append("<p><i>"+r+" most recent workspaces are shown.</i></p>")}}sRes&&i(sRes)}};i((e?"Inspecting":"Searching for")+" a workspace: "+(a||"*")),p.InvokeMethod("InspectWS",c,d)}function t(e,t){return e&&t&&function(){var i=e.split("*"),n=void 0,o=-1;t=i.reduce(function(e,t){return t&&(n=e.indexOf(t,o))&&(e=e.substr(0,n)+"<b>"+t+"</b>"+e.substr(n+t.length),o=n),e},t)}(),t}function i(e){e=(new Date).toLocaleTimeString()+" > "+e,a.push(e),a.length>3&&a.shift(),l.find(o+"Msg").html(a.join("<br>"))}if("undefined"==typeof SiebelApp)return void alert("It works only in Siebel OUI session!");var n="SiebelInspectWS",o="#"+n,r=10,s=JSON.parse(window.localStorage[n]||"[]"),a=[];if($("."+n).length)return void $("."+n).find(o+"IBtn").click();var p='<i><p>Welcome to Inspect Workspace UI</p>The text field accepts different formats:<br><ul><li> - an exact workspace name: vbabkin_20200924_d419_1</li><li> - a search pattern of workspace name: *d419*</li><li> - an exact search spec for Repository Workspace BC: [Parent Name] = "Release 21" AND [Created By] = LoginId()</li><li> - leave it empty to search / inspect most recent undelivered workspaces created by the active user</li></ul><p>Hit Enter to search for 10 most recent workspaces matching the provided name/pattern/spec and then click one of the workspaces in the list to inspect it. Hit Ctrl+Enter to inspect the most recent workspaces matching the provided name/pattern/spec.</p><p>If you just want to inspect/re-inspect your recent undelivered workspace, just hit Ctrl+Enter upon opening a dialog or double click a bookmark link.</p><p>Right-click on workspace name will copy the name or right-click whitespace to close the dialog.</p><p>Check out <a href="http://xapuk.com/index.php?topic=125">http://xapuk.com/</a> for details.</p></i>',c='<div title="Inspect Workspace"><span id = "'+n+'Help" style = "display:none">'+p+'</span><input placeholder = "<my recent undelivered workspace>" type="text" id = "'+n+'" list="'+n+'History" autocomplete="off"><p id = "'+n+'Msg"></p><ul id="'+n+'List"></ul><datalist id = "'+n+'History"></datalist><style>.'+n+" input {width: 100%!Important;}#"+n+"List{margin-left: 15px;}#"+n+"Help i{font-size: 0.8rem;}."+n+" li {list-style-type: disc;margin-left: 30px;}</style></div>",l=$(c).dialog({modal:!0,width:640,classes:{"ui-dialog":n},buttons:[{text:"Search (Enter)",click:function(){return e(!1)}},{id:n+"IBtn",text:"Inspect (Ctrl+Enter)",click:function(){return e(!0)}},{text:"Help",click:function(){return l.find(o+"Help").toggle()}},{text:"Close (Esc)",click:function(){return l.dialog("close")}}],open:function(){var t=$(this);t.find("#"+n).focus(),t.parent(".ui-dialog").contextmenu(function(e){var i=this,r=e.target;"A"===r.nodeName?(e.stopPropagation(),e.preventDefault(),$(r).hide().after("<input id='"+n+"Copy'>"),l.find(o+"Copy").val($(r).text()).select(),document.execCommand("copy",!1,null)?(l.find(o+"Copy").attr("disabled","disabled").css("color","red").val("Copied!"),setTimeout(function(){l.find(o+"Copy").remove(),$(r).show()},700)):l.find(o+"Copy").blur(function(){$(i).remove(),l.find("a").show()})):-1===["INPUT","A","BUTTON"].indexOf(r.nodeName)&&(t.dialog("close"),event.preventDefault(),event.stopPropagation())}).click(function(t){"A"===t.target.nodeName&&$(t.target).parents(o+"List").length&&e(!0,$(t.target).text())}).find(o).keydown(function(t){13===t.keyCode&&e(t.ctrlKey)}),$(".ui-widget-overlay").click(function(){return l.dialog("close")}),s.forEach(function(e){return t.find(o+"History").append("<option>"+e+"</option>")})},close:function(){l.dialog("destroy").remove()}})})();